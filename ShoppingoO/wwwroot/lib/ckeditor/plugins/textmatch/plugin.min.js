!function(){function a(t,e){for(var n=t.length,r=0,a=0;a<n;a+=1){var s=t[a];if(r<=e&&r+s.getText().length>=e)return{element:s,offset:e-r};r+=s.getText().length}return null}CKEDITOR.plugins.add("textmatch",{}),CKEDITOR.plugins.textMatch={},CKEDITOR.plugins.textMatch.match=function(t,e){var n=CKEDITOR.plugins.textMatch.getTextAndOffset(t),r=CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE,a=0;if(n)return 0==n.text.indexOf(r)&&(a=r.length,n.text=n.text.replace(r,""),n.offset-=a),(r=e(n.text,n.offset))?{range:CKEDITOR.plugins.textMatch.getRangeInText(t,r.start,r.end+a),text:n.text.slice(r.start,r.end)}:null},CKEDITOR.plugins.textMatch.getTextAndOffset=function(e){if(!e.collapsed)return null;for(var t="",n=0,r=CKEDITOR.plugins.textMatch.getAdjacentTextNodes(e),a=!1,s=e.startContainer.type!=CKEDITOR.NODE_ELEMENT,g=s?function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1}(r,function(t){return e.startContainer.equals(t)}):e.startOffset-(r[0]?r[0].getIndex():0),f=r.length,l=0;l<f;l+=1){var i=r[l],t=t+i.getText();a||(s?l==g?(a=!0,n+=e.startOffset):n+=i.getText().length:(l==g&&(a=!0),0<l&&(n+=r[l-1].getText().length),f==g&&l+1==f&&(n+=i.getText().length)))}return{text:t,offset:n}},CKEDITOR.plugins.textMatch.getRangeInText=function(t,e,n){var r=new CKEDITOR.dom.range(t.root);return e=a(t=CKEDITOR.plugins.textMatch.getAdjacentTextNodes(t),e),n=a(t,n),r.setStart(e.element,e.offset),r.setEnd(n.element,n.offset),r},CKEDITOR.plugins.textMatch.getAdjacentTextNodes=function(t){if(!t.collapsed)return[];for(var e,n,r=[],a=t=t.startContainer.type!=CKEDITOR.NODE_ELEMENT?(e=t.startContainer.getParent().getChildren(),t.startContainer.getIndex()):(e=t.startContainer.getChildren(),t.startOffset);(n=e.getItem(--a))&&n.type==CKEDITOR.NODE_TEXT;)r.unshift(n);for(a=t;(n=e.getItem(a++))&&n.type==CKEDITOR.NODE_TEXT;)r.push(n);return r}}();
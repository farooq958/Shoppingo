!function(){var a=/^<a[^>]+href="([^"]+)"[^>]*>([^<]+)<\/a>$/i;CKEDITOR.plugins.add("autoembed",{requires:"autolink,undo",lang:"ar,az,bg,ca,cs,da,de,de-ch,el,en,en-au,eo,es,es-mx,et,eu,fa,fr,gl,hr,hu,id,it,ja,km,ko,ku,lt,lv,mk,nb,nl,oc,pl,pt,pt-br,ro,ru,sk,sq,sr,sr-latn,sv,tr,ug,uk,vi,zh,zh-cn",init:function(o){var d,c=1;o.on("paste",function(e){var t;e.data.dataTransfer.getTransferType(o)==CKEDITOR.DATA_TRANSFER_INTERNAL?d=0:(t=e.data.dataValue.match(a),(d=null!=t&&decodeURI(t[1])==decodeURI(t[2]))&&(e.data.dataValue='<a data-cke-autoembed="'+ ++c+'"'+e.data.dataValue.substr(2)))},null,null,20),o.on("afterPaste",function(){var r,s,u,e,t,a,l,f,n,i;d&&(s=c,n=(r=o).editable().findOne('a[data-cke-autoembed="'+s+'"]'),i=r.lang.autoembed,n&&n.data("cke-saved-href")&&(n=n.data("cke-saved-href"),(e=CKEDITOR.plugins.autoEmbed.getWidgetDefinition(r,n))?(t="function"==typeof e.defaults?e.defaults():e.defaults,t=CKEDITOR.dom.element.createFromHtml(e.template.output(t)),l=r.widgets.wrapElement(t,e.name),(f=new CKEDITOR.dom.documentFragment(l.getDocument())).append(l),(a=r.widgets.initOn(t,e))?(u=r.showNotification(i.embeddingInProgress,"info"),a.loadContent(n,{noNotifications:!0,callback:function(){var e,t,a,n,i,o,d=r.editable().findOne('a[data-cke-autoembed="'+s+'"]');d&&(e=r.getSelection(),t=r.createRange(),a=r.editable(),r.fire("saveSnapshot"),r.fire("lockSnapshot",{dontUpdate:!0}),i=(n=e.createBookmarks(!1)[0]).startNode,o=n.endNode||i,CKEDITOR.env.ie&&CKEDITOR.env.version<9&&!n.endNode&&i.equals(d.getNext())&&d.append(i),t.setStartBefore(d),t.setEndAfter(d),a.insertElement(l,t),a.contains(i)&&a.contains(o)?e.selectBookmarks([n]):(i.remove(),o.remove()),r.fire("unlockSnapshot")),u.hide(),r.widgets.finalizeCreation(f)},errorCallback:function(){u.hide(),r.widgets.destroy(a,!0),r.showNotification(i.embeddingFailed,"info")}})):r.widgets.finalizeCreation(f)):CKEDITOR.warn("autoembed-no-widget-def")))})}}),CKEDITOR.plugins.autoEmbed={getWidgetDefinition:function(e,t){var a,n=e.config.autoEmbed_widget||"embed,embedSemantic",i=e.widgets.registered;if("string"==typeof n){for(n=n.split(",");a=n.shift();)if(i[a])return i[a]}else if("function"==typeof n)return i[n(t)];return null}}}();
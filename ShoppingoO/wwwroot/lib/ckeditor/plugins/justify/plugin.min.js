!function(){function h(t,e){var s;if(e=void 0===e||e)s=t.getComputedStyle("text-align");else{for(;(!t.hasAttribute||!t.hasAttribute("align")&&!t.getStyle("text-align"))&&(s=t.getParent());)t=s;s=t.getStyle("text-align")||t.getAttribute("align")||""}return s=!(s=s&&s.replace(/(?:-(?:moz|webkit)-)?(?:start|auto)/i,""))&&e?"rtl"==t.getComputedStyle("direction")?"right":"left":s}function l(t,e,s){this.editor=t,this.name=e,this.value=s,this.context="p",e=t.config.justifyClasses;var a=t.config.enterMode==CKEDITOR.ENTER_P?"p":"div";if(e){switch(s){case"left":this.cssClassName=e[0];break;case"center":this.cssClassName=e[1];break;case"right":this.cssClassName=e[2];break;case"justify":this.cssClassName=e[3]}this.cssClassRegex=new RegExp("(?:^|\\s+)(?:"+e.join("|")+")(?=$|\\s)"),this.requiredContent=a+"("+this.cssClassName+")"}else this.requiredContent=a+"{text-align}";this.allowedContent={"caption div h1 h2 h3 h4 h5 h6 p pre td th li":{propertiesOnly:!0,styles:this.cssClassName?null:"text-align",classes:this.cssClassName||null}},t.config.enterMode==CKEDITOR.ENTER_BR&&(this.allowedContent.div=!0)}function n(t){var e=t.editor,s=e.createRange();s.setStartBefore(t.data.node),s.setEndAfter(t.data.node);for(var a,i,l=new CKEDITOR.dom.walker(s);a=l.next();)a.type==CKEDITOR.NODE_ELEMENT&&(!a.equals(t.data.node)&&a.getDirection()?(s.setStartAfter(a),l=new CKEDITOR.dom.walker(s)):((i=e.config.justifyClasses)&&(a.hasClass(i[0])?(a.removeClass(i[0]),a.addClass(i[2])):a.hasClass(i[2])&&(a.removeClass(i[2]),a.addClass(i[0]))),"left"==(i=a.getStyle("text-align"))?a.setStyle("text-align","right"):"right"==i&&a.setStyle("text-align","left")))}l.prototype={exec:function(t){var e=t.getSelection(),s=t.config.enterMode;if(e){for(var a,i,l,n,o,r,c=e.createBookmarks(),d=e.getRanges(),u=this.cssClassName,g=void 0===(g=t.config.useComputedState)||g,f=d.length-1;0<=f;f--)for((a=d[f].createIterator()).enlargeBr=s!=CKEDITOR.ENTER_BR;i=a.getNextParagraph(s==CKEDITOR.ENTER_P?"p":"div");)i.isReadOnly()||(l=i.getName(),r=t.activeFilter.check(l+"{text-align}"),((l=t.activeFilter.check(l+"("+u+")"))||r)&&(i.removeAttribute("align"),i.removeStyle("text-align"),n=u&&(i.$.className=CKEDITOR.tools.ltrim(i.$.className.replace(this.cssClassRegex,""))),o=this.state==CKEDITOR.TRISTATE_OFF&&(!g||h(i,!0)!=this.value),u&&l?o?i.addClass(u):n||i.removeAttribute("class"):o&&r&&i.setStyle("text-align",this.value)));t.focus(),t.forceNextSelectionCheck(),e.selectBookmarks(c)}},refresh:function(t,e){var s=e.block||e.blockLimit,a=s.getName(),i=s.equals(t.editable()),a=this.cssClassName?t.activeFilter.check(a+"("+this.cssClassName+")"):t.activeFilter.check(a+"{text-align}");i&&!CKEDITOR.dtd.$list[e.lastElement.getName()]?this.setState(CKEDITOR.TRISTATE_OFF):!i&&a?this.setState(h(s,this.editor.config.useComputedState)==this.value?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)}},CKEDITOR.plugins.add("justify",{icons:"justifyblock,justifycenter,justifyleft,justifyright",hidpi:!0,init:function(t){var e,s,a,i;t.blockless||(e=new l(t,"justifyleft","left"),s=new l(t,"justifycenter","center"),a=new l(t,"justifyright","right"),i=new l(t,"justifyblock","justify"),t.addCommand("justifyleft",e),t.addCommand("justifycenter",s),t.addCommand("justifyright",a),t.addCommand("justifyblock",i),t.ui.addButton&&(t.ui.addButton("JustifyLeft",{label:t.lang.common.alignLeft,command:"justifyleft",toolbar:"align,10"}),t.ui.addButton("JustifyCenter",{label:t.lang.common.center,command:"justifycenter",toolbar:"align,20"}),t.ui.addButton("JustifyRight",{label:t.lang.common.alignRight,command:"justifyright",toolbar:"align,30"}),t.ui.addButton("JustifyBlock",{label:t.lang.common.justify,command:"justifyblock",toolbar:"align,40"})),t.on("dirChanged",n))}})}();
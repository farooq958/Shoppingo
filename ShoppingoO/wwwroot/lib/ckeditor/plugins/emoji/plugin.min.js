!function(){function l(e){return e.name||(e.name=s(e.id.replace(/::.*$/,":").replace(/^:|:$/g,""))),e}var e=!1,o=CKEDITOR.tools.array,s=CKEDITOR.tools.htmlEncode,t=CKEDITOR.tools.createClass({$:function(n,e){var t=this.lang=n.lang.emoji,o=this;this.listeners=[],this.plugin=e,this.editor=n,this.groups=[{name:"people",sectionName:t.groups.people,svgId:"cke4-icon-emoji-2",position:{x:-21,y:0},items:[]},{name:"nature",sectionName:t.groups.nature,svgId:"cke4-icon-emoji-3",position:{x:-42,y:0},items:[]},{name:"food",sectionName:t.groups.food,svgId:"cke4-icon-emoji-4",position:{x:-63,y:0},items:[]},{name:"travel",sectionName:t.groups.travel,svgId:"cke4-icon-emoji-6",position:{x:-42,y:-21},items:[]},{name:"activities",sectionName:t.groups.activities,svgId:"cke4-icon-emoji-5",position:{x:-84,y:0},items:[]},{name:"objects",sectionName:t.groups.objects,svgId:"cke4-icon-emoji-7",position:{x:0,y:-21},items:[]},{name:"symbols",sectionName:t.groups.symbols,svgId:"cke4-icon-emoji-8",position:{x:-21,y:-21},items:[]},{name:"flags",sectionName:t.groups.flags,svgId:"cke4-icon-emoji-9",position:{x:-63,y:-21},items:[]}],this.elements={},n.ui.addToolbarGroup("emoji","insert"),n.ui.add("EmojiPanel",CKEDITOR.UI_PANELBUTTON,{label:"emoji",title:t.title,modes:{wysiwyg:1},editorFocus:0,toolbar:"insert",panel:{css:[CKEDITOR.skin.getPath("editor"),e.path+"skins/default.css"],attributes:{role:"listbox","aria-label":t.title},markFirst:!1},onBlock:function(e,t){var i=t.keys,s="rtl"===n.lang.dir;i[s?37:39]="next",i[40]="next",i[9]="next",i[s?39:37]="prev",i[38]="prev",i[CKEDITOR.SHIFT+9]="prev",i[32]="click",o.blockElement=t.element,o.emojiList=o.editor._.emoji.list,o.addEmojiToGroups(),t.element.getAscendant("html").addClass("cke_emoji"),t.element.getDocument().appendStyleSheet(CKEDITOR.getUrl(CKEDITOR.basePath+"contents.css")),t.element.addClass("cke_emoji-panel_block"),t.element.setHtml(o.createEmojiBlock()),t.element.removeAttribute("title"),e.element.addClass("cke_emoji-panel"),o.items=t._.getItems(),o.blockObject=t,o.elements.emojiItems=t.element.find(".cke_emoji-outer_emoji_block li > a"),o.elements.sectionHeaders=t.element.find(".cke_emoji-outer_emoji_block h2"),o.elements.input=t.element.findOne("input"),o.inputIndex=o.getItemIndex(o.items,o.elements.input),o.elements.emojiBlock=t.element.findOne(".cke_emoji-outer_emoji_block"),o.elements.navigationItems=t.element.find("nav li"),o.elements.statusIcon=t.element.findOne(".cke_emoji-status_icon"),o.elements.statusDescription=t.element.findOne("p.cke_emoji-status_description"),o.elements.statusName=t.element.findOne("p.cke_emoji-status_full_name"),o.elements.sections=t.element.find("section"),o.registerListeners()},onOpen:o.openReset()})},proto:{registerListeners:function(){o.forEach(this.listeners,function(e){var t=e.listener,i=e.event,s=e.ctx||this;o.forEach(this.blockElement.find(e.selector).toArray(),function(e){e.on(i,t,s)})},this)},createEmojiBlock:function(){var e=[];return this.loadSVGNavigationIcons(),e.push(this.createGroupsNavigation()),e.push(this.createSearchSection()),e.push(this.createEmojiListBlock()),e.push(this.createStatusBar()),'<div class="cke_emoji-inner_panel">'+e.join("")+"</div>"},createGroupsNavigation:function(){var i,e=this.editor.plugins.emoji.isSVGSupported()?(e=CKEDITOR.env.safari?'xlink:href="#{svgId}"':'href="#{svgId}"',i=new CKEDITOR.template('<li class="cke_emoji-navigation_item" data-cke-emoji-group="{group}"><a href="#" title="{name}" draggable="false" _cke_focus="1"><svg viewBox="0 0 34 34" aria-labelledby="{svgId}-title"><title id="{svgId}-title">{name}</title><use '+e+"></use></svg></a></li>"),o.reduce(this.groups,function(e,t){return t.items.length?e+i.output({group:s(t.name),name:s(t.sectionName),svgId:s(t.svgId),translateX:t.translate&&t.translate.x?s(t.translate.x):0,translateY:t.translate&&t.translate.y?s(t.translate.y):0}):e},"")):(e=CKEDITOR.getUrl(this.plugin.path+"assets/iconsall.png"),i=new CKEDITOR.template('<li class="cke_emoji-navigation_item" data-cke-emoji-group="{group}"><a href="#" draggable="false" _cke_focus="1" title="{name}"><span style="background-image:url('+e+');background-repeat:no-repeat;background-position:{positionX}px {positionY}px;"></span></a></li>'),o.reduce(this.groups,function(e,t){return t.items.length?e+i.output({group:s(t.name),name:s(t.sectionName),positionX:t.position.x,positionY:t.position.y}):e},""));return this.listeners.push({selector:"nav",event:"click",listener:function(e){var t=e.data.getTarget().getAscendant("li",!0);t&&(o.forEach(this.elements.navigationItems.toArray(),function(e){e.equals(t)?e.addClass("active"):e.removeClass("active")}),this.clearSearchAndMoveFocus(t),e.data.preventDefault())}}),'<nav aria-label="'+s(this.lang.navigationLabel)+'"><ul>'+e+"</ul></nav>"},createSearchSection:function(){return this.listeners.push({selector:"input",event:"input",listener:CKEDITOR.tools.throttle(200,this.filter,this).input}),this.listeners.push({selector:"input",event:"click",listener:function(){this.blockObject._.markItem(this.inputIndex)}}),'<label class="cke_emoji-search">'+this.getLoupeIcon()+'<input placeholder="'+s(this.lang.searchPlaceholder)+'" type="search" aria-label="'+s(this.lang.searchLabel)+'" role="search" _cke_focus="1"></label>'},createEmojiListBlock:function(){return this.listeners.push({selector:".cke_emoji-outer_emoji_block",event:"scroll",listener:CKEDITOR.tools.throttle(150,this.refreshNavigationStatus,this).input}),this.listeners.push({selector:".cke_emoji-outer_emoji_block",event:"click",listener:function(e){e.data.getTarget().data("cke-emoji-name")&&this.editor.execCommand("insertEmoji",{emojiText:e.data.getTarget().data("cke-emoji-symbol")})}}),this.listeners.push({selector:".cke_emoji-outer_emoji_block",event:"mouseover",listener:function(e){this.updateStatusbar(e.data.getTarget())}}),this.listeners.push({selector:".cke_emoji-outer_emoji_block",event:"keyup",listener:function(){this.updateStatusbar(this.items.getItem(this.blockObject._.focusIndex))}}),'<div class="cke_emoji-outer_emoji_block">'+this.getEmojiSections()+"</div>"},createStatusBar:function(){return'<div class="cke_emoji-status_bar"><div class="cke_emoji-status_icon"></div><p class="cke_emoji-status_description"></p><p class="cke_emoji-status_full_name"></p></div>'},getLoupeIcon:function(){var e=CKEDITOR.getUrl(this.plugin.path+"assets/iconsall.png");return this.editor.plugins.emoji.isSVGSupported()?'<svg viewBox="0 0 34 34" role="img" aria-hidden="true" class="cke_emoji-search_loupe"><use '+(e=CKEDITOR.env.safari?'xlink:href="#cke4-icon-emoji-10"':'href="#cke4-icon-emoji-10"')+"></use></svg>":'<span class="cke_emoji-search_loupe" aria-hidden="true" style="background-image:url('+e+');"></span>'},getEmojiSections:function(){return o.reduce(this.groups,function(e,t){return t.items.length?e+this.getEmojiSection(t):e},"",this)},getEmojiSection:function(e){var t=s(e.name);return'<section data-cke-emoji-group="'+t+'" ><h2 id="'+t+'">'+s(e.sectionName)+"</h2><ul>"+(e=this.getEmojiListGroup(e.items))+"</ul></section>"},getEmojiListGroup:function(e){var i=new CKEDITOR.template('<li class="cke_emoji-item"><a draggable="false" data-cke-emoji-full-name="{id}" data-cke-emoji-name="{name}" data-cke-emoji-symbol="{symbol}" data-cke-emoji-group="{group}" data-cke-emoji-keywords="{keywords}" title="{name}" href="#" _cke_focus="1">{symbol}</a></li>');return o.reduce(e,function(e,t){return l(t),e+i.output({symbol:s(t.symbol),id:s(t.id),name:t.name,group:s(t.group),keywords:s((t.keywords||[]).join(","))})},"",this)},filter:function(e){var s={},n="string"==typeof e?e:e.sender.getValue();o.forEach(this.elements.emojiItems.toArray(),function(e){e:{var t=e.data("cke-emoji-name"),i=e.data("cke-emoji-keywords");if(-1!==t.indexOf(n))t=!0;else{if(i)for(t=i.split(","),i=0;i<t.length;i++)if(-1!==t[i].indexOf(n)){t=!0;break e}t=!1}}t||""===n?(e.removeClass("hidden"),e.getParent().removeClass("hidden"),s[e.data("cke-emoji-group")]=!0):(e.addClass("hidden"),e.getParent().addClass("hidden"))}),o.forEach(this.elements.sectionHeaders.toArray(),function(e){s[e.getId()]?(e.getParent().removeClass("hidden"),e.removeClass("hidden")):(e.addClass("hidden"),e.getParent().addClass("hidden"))}),this.refreshNavigationStatus()},clearSearchInput:function(){this.elements.input.setValue(""),this.filter("")},openReset:function(){var e,t=this;return function(){e||(t.filter(""),e=!0),t.elements.emojiBlock.$.scrollTop=0,t.refreshNavigationStatus(),t.clearSearchInput(),CKEDITOR.tools.setTimeout(function(){t.elements.input.focus(!0),t.blockObject._.markItem(t.inputIndex)},0,t),t.clearStatusbar()}},refreshNavigationStatus:function(){var i=this.elements.emojiBlock.getClientRect().top,e=o.filter(this.elements.sections.toArray(),function(e){var t=e.getClientRect();return!(!t.height||e.findOne("h2").hasClass("hidden"))&&t.height+t.top>i}),t=!!e.length&&e[0].data("cke-emoji-group");o.forEach(this.elements.navigationItems.toArray(),function(e){e.data("cke-emoji-group")===t?e.addClass("active"):e.removeClass("active")})},updateStatusbar:function(e){"a"===e.getName()&&e.hasAttribute("data-cke-emoji-name")&&(this.elements.statusIcon.setText(s(e.getText())),this.elements.statusDescription.setText(s(e.data("cke-emoji-name"))),this.elements.statusName.setText(s(e.data("cke-emoji-full-name"))))},clearStatusbar:function(){this.elements.statusIcon.setText(""),this.elements.statusDescription.setText(""),this.elements.statusName.setText("")},clearSearchAndMoveFocus:function(e){this.clearSearchInput(),this.moveFocus(e.data("cke-emoji-group"))},moveFocus:function(e){var t;(e=this.blockElement.findOne('a[data-cke-emoji-group="'+s(e)+'"]'))&&(t=this.getItemIndex(this.items,e),e.focus(!0),e.getAscendant("section").getFirst().scrollIntoView(!0),this.blockObject._.markItem(t))},getItemIndex:function(e,t){return o.indexOf(e.toArray(),function(e){return e.equals(t)})},loadSVGNavigationIcons:function(){var i;this.editor.plugins.emoji.isSVGSupported()&&(i=this.blockElement.getDocument(),CKEDITOR.ajax.load(CKEDITOR.getUrl(this.plugin.path+"assets/iconsall.svg"),function(e){var t=new CKEDITOR.dom.element("div");t.addClass("cke_emoji-navigation_icons"),t.setHtml(e),i.getBody().append(t)}))},addEmojiToGroups:function(){var t={};o.forEach(this.groups,function(e){t[e.name]=e.items},this),o.forEach(this.emojiList,function(e){t[e.group].push(e)},this)}}});CKEDITOR.plugins.add("emoji",{requires:"autocomplete,textmatch,ajax,panelbutton,floatpanel",lang:"cs,da,de,de-ch,en,en-au,et,fa,fr,gl,hr,hu,it,nl,pl,pt-br,sk,sr,sr-latn,sv,tr,uk,zh,zh-cn",icons:"emojipanel",hidpi:!0,isSupportedEnvironment:function(){return!CKEDITOR.env.ie||11<=CKEDITOR.env.version},beforeInit:function(){this.isSupportedEnvironment()&&!e&&(CKEDITOR.document.appendStyleSheet(this.path+"skins/default.css"),e=!0)},init:function(a){var r;this.isSupportedEnvironment()&&(r=CKEDITOR.tools.array,CKEDITOR.ajax.load(CKEDITOR.getUrl(a.config.emoji_emojiListUrl||"plugins/emoji/emoji.json"),function(e){function t(){a._.emoji.autocomplete=new CKEDITOR.plugins.autocomplete(a,{textTestCallback:function(e){return e.collapsed?CKEDITOR.plugins.textMatch.match(e,i):null},dataCallback:s,itemTemplate:'<li data-id="{id}" class="cke_emoji-suggestion_item"><span>{symbol}</span> {name}</li>',outputTemplate:"{symbol}"})}function i(e,t){var i=e.slice(0,t),e=i.match(new RegExp("(?:\\s|^)(:\\S{"+o+"}\\S*)$"));return e?{start:i.lastIndexOf(e[1]),end:t}:null}function s(e,t){var s=e.query.substr(1).toLowerCase(),e=r.filter(n,function(e){return-1!==e.id.toLowerCase().indexOf(s)}).sort(function(e,t){var i=!e.id.substr(1).indexOf(s);return i!=!t.id.substr(1).indexOf(s)?i?-1:1:e.id>t.id?1:-1});t(e=r.map(e,l))}var n,o;null!==e&&(void 0===a._.emoji&&(a._.emoji={}),void 0===a._.emoji.list&&(a._.emoji.list=JSON.parse(e)),n=a._.emoji.list,o=void 0===a.config.emoji_minChars?2:a.config.emoji_minChars,"ready"!==a.status?a.once("instanceReady",t):t())}),a.addCommand("insertEmoji",{exec:function(e,t){e.insertHtml(t.emojiText)}}),a.plugins.toolbar&&new t(a,this))},isSVGSupported:function(){return!CKEDITOR.env.ie||CKEDITOR.env.edge}})}();
CKEDITOR.plugins.add("iframedialog",{requires:"dialog",onLoad:function(){function o(e,n,t){var o,i,d,a,r,l;arguments.length<3||(o=this._||(this._={}),i=n.onContentLoad&&CKEDITOR.tools.bind(n.onContentLoad,this),d=CKEDITOR.tools.cssLength(n.width),a=CKEDITOR.tools.cssLength(n.height),o.frameId=CKEDITOR.tools.getNextId()+"_iframe",e.on("load",function(){CKEDITOR.document.getById(o.frameId).getParent().setStyles({width:d,height:a})}),r={src:"%2",id:o.frameId,frameborder:0,allowtransparency:!0},l=[],"function"==typeof n.onContentLoad&&(r.onload="CKEDITOR.tools.callFunction(%1);"),CKEDITOR.ui.dialog.uiElement.call(this,e,n,l,"iframe",{width:d,height:a},r,""),t.push('<div style="width:'+d+";height:"+a+';" id="'+this.domId+'"></div>'),l=l.join(""),e.on("show",function(){var e=CKEDITOR.document.getById(o.frameId).getParent(),t=CKEDITOR.tools.addFunction(i),t=l.replace("%1",t).replace("%2",CKEDITOR.tools.htmlEncode(n.src));e.setHtml(t)}))}CKEDITOR.dialog.addIframe=function(e,t,n,o,i,d,a){(n={type:"iframe",src:n,width:"100%",height:"100%"}).onContentLoad="function"==typeof d?d:function(){var t,n,o=this.getElement().$.contentWindow;o.onDialogEvent&&((t=this.getDialog()).on("ok",n=function(e){return o.onDialogEvent(e)}),t.on("cancel",n),t.on("resize",n),t.on("hide",function(e){t.removeListener("ok",n),t.removeListener("cancel",n),t.removeListener("resize",n),e.removeListener()}),o.onDialogEvent({name:"load",sender:this,editor:t._.editor}))};var r,l={title:t,minWidth:o,minHeight:i,contents:[{id:"iframe",label:t,expand:!0,elements:[n],style:"width:"+n.width+";height:"+n.height}]};for(r in a)l[r]=a[r];this.add(e,function(){return l})},o.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.dialog.addUIElement("iframe",{build:function(e,t,n){return new o(e,t,n)}})}});
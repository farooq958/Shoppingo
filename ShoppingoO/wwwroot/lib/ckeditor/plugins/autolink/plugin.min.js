CKEDITOR.plugins.add("autolink",{requires:"clipboard,textmatch,link",isSupportedEnvironment:function(){return!CKEDITOR.env.ie||CKEDITOR.env.edge},init:function(a){function i(t){t=CKEDITOR.tools.htmlDecodeAttr(t);var e=new CKEDITOR.dom.element("a"),n=(n=t.replace(/"/g,"%22")).match(CKEDITOR.config.autolink_urlRegex)?n:"mailto:"+n;return e.setText(t),e.setAttribute("href",n),t=CKEDITOR.plugins.link.parseLinkAttributes(a,e),t=CKEDITOR.plugins.link.getLinkAttributes(a,t),CKEDITOR.tools.isEmpty(t.set)||e.setAttributes(t.set),t.removed.length&&e.removeAttributes(t.removed),e.removeAttribute("data-cke-saved-href"),e.getOuterHtml()}function r(t,e){var n=t.slice(0,e).split(/\s+/);return(n=n[n.length-1])&&o(n)?{start:t.lastIndexOf(n),end:e}:null}function o(t){return t.match(a.config.autolink_urlRegex)||t.match(a.config.autolink_emailRegex)}this.isSupportedEnvironment()&&(a.on("paste",function(t){var e;t.data.dataTransfer.getTransferType(a)!=CKEDITOR.DATA_TRANSFER_INTERNAL&&(-1<(e=t.data.dataValue).indexOf("<")||!o(e)||(t.data.dataValue=i(e),t.data.type="html"))}),a.on("key",function(t){var e,n;"wysiwyg"===a.mode&&-1!=CKEDITOR.tools.indexOf(a.config.autolink_commitKeystrokes,t.data.keyCode)&&(!(e=CKEDITOR.plugins.textMatch.match(a.getSelection().getRanges()[0],r))||((t=a.getSelection()).getRanges()[0].startContainer.getAscendant("a",!0)||(t.selectRanges([e.range]),a.insertHtml(i(e.text),"text"),CKEDITOR.env.webkit))||(e=t.getRanges()[0],(n=a.createRange()).setStartAfter(e.startContainer),t.selectRanges([n])))}))}}),CKEDITOR.config.autolink_commitKeystrokes=[13,32],CKEDITOR.config.autolink_urlRegex=/^(https?|ftp):\/\/(-\.)?([^\s\/?\.#]\.?)+(\/[^\s]*)?[^\s\.,]$/i,CKEDITOR.config.autolink_emailRegex=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
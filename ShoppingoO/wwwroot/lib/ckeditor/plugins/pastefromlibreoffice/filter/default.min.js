!function(){function e(t,e){if(t.previous&&a(t.previous)&&t.getFirst().children.length&&1===t.children.length&&a(t.getFirst().getFirst())){for(var r,i=function t(e){var r=e.children[e.children.length-1];return a(r)||"li"===r.name?t(r):e}(t.previous),n=0,s=i,l=(r=!1,function(t){return!r&&(a(t)||"li"===t.name?a(t):!(r=!0))});s=s.getAscendant(l);)n++;return(n=function t(e,r){return r?t(e.getFirst().getFirst(),--r):e}(t,n))&&(i.add(n),n.filterChildren(e),1)}}function a(t){return"ol"===t.name||"ul"===t.name}function r(){return!1}var t=CKEDITOR.plugins.pastetools,i=t.filters.common,s=i.styles;CKEDITOR.plugins.pastetools.filters.libreoffice={rules:function(t,i,n){return{root:function(t){t.filterChildren(n)},comment:function(){return!1},elementNames:[[/^head$/i,""],[/^meta$/i,""],[/^strike$/i,"s"]],elements:{"!doctype":function(t){t.replaceWithChildren()},span:function(t){t.attributes.style&&(t.attributes.style=s.normalizedStyles(t,i),s.createStyleStack(t,n,i)),CKEDITOR.tools.object.entries(t.attributes).length||t.replaceWithChildren()},p:function(t){var e,r=CKEDITOR.tools.parseCssText(t.attributes.style);!i.plugins.pagebreak||"always"!==r["page-break-before"]&&"page"!==r["break-before"]||(e=CKEDITOR.plugins.pagebreak.createElement(i),(e=CKEDITOR.htmlParser.fragment.fromHtml(e.getOuterHtml()).children[0]).insertBefore(t)),t.attributes.style=CKEDITOR.tools.writeCssText(r),t.filterChildren(n),s.createStyleStack(t,n,i)},div:function(t){s.createStyleStack(t,n,i)},a:function(t){var e;t.attributes.style&&(e=t.attributes,"#000080"===(t=CKEDITOR.tools.parseCssText(t.attributes.style)).color&&delete t.color,"underline"===t["text-decoration"]&&delete t["text-decoration"],t=CKEDITOR.tools.writeCssText(t),e.style=t)},h1:function(t){s.createStyleStack(t,n,i)},h2:function(t){s.createStyleStack(t,n,i)},h3:function(t){s.createStyleStack(t,n,i)},h4:function(t){s.createStyleStack(t,n,i)},h5:function(t){s.createStyleStack(t,n,i)},h6:function(t){s.createStyleStack(t,n,i)},pre:function(t){s.createStyleStack(t,n,i)},font:function(t){var e="a"===t.parent.name&&"#000080"===t.attributes.color||1===t.parent.children.length&&("sup"===t.parent.name||"sub"===t.parent.name)&&"2"===t.attributes.size;e&&t.replaceWithChildren(),e=CKEDITOR.tools.parseCssText(t.attributes.style);var r=t.getFirst();t.attributes.size&&r&&r.type===CKEDITOR.NODE_ELEMENT&&/font-size/.test(r.attributes.style)&&t.replaceWithChildren(),e["font-size"]&&(delete t.attributes.size,t.name="span",r&&r.type===CKEDITOR.NODE_ELEMENT&&r.attributes.size&&r.replaceWithChildren())},ul:function(t){if(e(t,n))return!1},ol:function(t){if(e(t,n))return!1},img:function(t){if(!t.attributes.src)return!1},table:function(t){var e=t.attributes;t=t.attributes.style;var r=CKEDITOR.tools.parseCssText(t);r["border-collapse"]||(r["border-collapse"]="collapse",t=CKEDITOR.tools.writeCssText(r)),e.style=t}},attributes:{style:function(t,e){return s.normalizedStyles(e,i)||!1},align:function(t,e){if("img"!==e.name){var r=CKEDITOR.tools.parseCssText(e.attributes.style);return r["text-align"]=e.attributes.align,e.attributes.style=CKEDITOR.tools.writeCssText(r),!1}},cellspacing:r,cellpadding:r,border:r}}}},CKEDITOR.pasteFilters.libreoffice=t.createFilter({rules:[i.rules,CKEDITOR.plugins.pastetools.filters.libreoffice.rules]})}();